# Infrastructure Layer Architecture

```
+---------------------------------------------------------------------------------------------------------------------+
|                                    Infrastructure Layer (GCP) - Detailed View                                        |
+---------------------------------------------------------------------------------------------------------------------+
|                                                                                                                     |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|  |    Google Kubernetes    |      |       Cloud Run         |      |    Artifact Registry    |                       |
|  |    Engine (GKE)         | <--> |                         | <--> |                         |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  | | Agent Pods      |     |      | | Stateless       |     |      | | Container       |     |                       |
|  | | - Orchestrator  |     |      | | Services        |     |      | | Images          |     |                       |
|  | | - Vector DB     |     |      | | - API Gateway   |     |      | | - Service Images|     |                       |
|  | | - Doc Processor |     |      | | - Compliance    |     |      | | - UI Images     |     |                       |
|  | | - Monitoring    |     |      | | - Cost Optimizer|     |      | | - Agent Images  |     |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|              ^                                 ^                                 ^                                  |
|              |                                 |                                 |                                  |
|              v                                 v                                 v                                  |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|  |     Cloud Storage       |      |        Cloud SQL        |      |        Pub/Sub         |                       |
|  |                         |      |                         |      |                         |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  | | Buckets         |     |      | | Databases       |     |      | | Topics          |     |                       |
|  | | - Medical Docs  |     |      | | - Config DB     |     |      | | - Doc Ingestion |     |                       |
|  | | - Embeddings    |     |      | | - User Data     |     |      | | - Agent Events  |     |                       |
|  | | - Model Artifacts|    |      | | - Metrics       |     |      | | - Compliance    |     |                       |
|  | | - Logs          |     |      | | - Audit Logs    |     |      | | - Alerts        |     |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|              ^                                 ^                                 ^                                  |
|              |                                 |                                 |                                  |
|              v                                 v                                 v                                  |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|  |      Vertex AI          |      |    Cloud Healthcare     |      |     Secret Manager      |                       |
|  |                         |      |          API            |      |                         |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  | | Services        |     |      | | FHIR Store      |     |      | | Secrets         |     |                       |
|  | | - Gemini Models |     |      | | - Medical Data  |     |      | | - API Keys      |     |                       |
|  | | - Embeddings    |     |      | | - Patient Info  |     |      | | - Credentials   |     |                       |
|  | | - Agent Builder |     |      | | - EHR           |     |      | | - Certificates  |     |                       |
|  | | - Tuning        |     |      | | - HIPAA Compliant|    |      | | - Tokens        |     |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|              ^                                 ^                                 ^                                  |
|              |                                 |                                 |                                  |
|              v                                 v                                 v                                  |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|  |    Cloud Monitoring     |      |      Cloud Logging      |      |    Identity & Access    |                       |
|  |                         |      |                         |      |    Management (IAM)     |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  | | Features        |     |      | | Log Types       |     |      | | Resources       |     |                       |
|  | | - Dashboards    |     |      | | - Application   |     |      | | - Service Accts |     |                       |
|  | | - Alerts        |     |      | | - System        |     |      | | - Roles         |     |                       |
|  | | - Metrics       |     |      | | - Audit         |     |      | | - Permissions   |     |                       |
|  | | - Uptime Checks |     |      | | - Security      |     |      | | - HIPAA Controls|     |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|              ^                                 ^                                 ^                                  |
|              |                                 |                                 |                                  |
|              v                                 v                                 v                                  |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|  |    Virtual Private      |      |     Cloud Endpoints     |      |     Cloud Scheduler     |                       |
|  |    Cloud (VPC)          |      |                         |      |                         |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  | | Network         |     |      | | API Management  |     |      | | Jobs            |     |                       |
|  | | - Subnets       |     |      | | - API Gateway   |     |      | | - Batch Jobs    |     |                       |
|  | | - Firewalls     |     |      | | - Authentication|     |      | | - Maintenance   |     |                       |
|  | | - Load Balancers|     |      | | - Rate Limiting |     |      | | - Reporting     |     |                       |
|  | | - Cloud NAT     |     |      | | - Analytics     |     |      | | - Cleanup       |     |                       |
|  | +-----------------+     |      | +-----------------+     |      | +-----------------+     |                       |
|  +-------------------------+      +-------------------------+      +-------------------------+                       |
|                                                                                                                     |
+---------------------------------------------------------------------------------------------------------------------+
```
